let e=a=>a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i,(b,c,d,f,k)=>"#"+c+c+d+d+f+f+k+k).substring(1).match(/.{2}/g).map(b=>parseInt(b,16)),h=" 2rwzo  58jgo 55eyo    34ao 7k b28 m0 20o0o 9a7vy jbmjj jhza7 ivhmm etrs7 ju8e7 jalrz jyn66 jwdj3 jwdlv 2t8g 2t8s 34yo lskg m2yo jf4lo jysjy 98ruh j8htq 9v7zj j8d32 ju78f ju8t4 9ul2n g44e1 jykrj jewdq g4rbt fgsgv hha5t g6xgz 98rou j8d7c 98uwe j8d7d 9xgxq jyy6c g3zn2 g3z9g b1ipn h4qu3 c8oz2 jhyfz    ".split(" "),l={},n=(a,{text:b,x:c,y:d,color:f=m.D,
textAlign:k="left",size:g=2,O:R=999})=>{b||=" ";let z=5*g,p=z+1*g,q=p*b.length,A=b+f+g,K="left"===k?0:"center"===k?q/2:q;if(l[A])b=R*p,a.drawImage(l[A],0,0,b,p,c-K,d,b,p);else{let r=new ImageData(q,z),[S,T,U,V]=e(f);b.replace("!","@").toUpperCase().split("").forEach((B,W)=>{String(parseInt(" "===B?"0":h[B.charCodeAt(0)-35],36).toString(2)).padStart(25,"0").split("").forEach((t,X)=>{if("0"!==t)for(t=0;t<g;t++){var C=X*g;C=4*(W*p+C%z+g*q*Math.floor(C/z)+q*t);for(let G=0;G<g;G++){let D=4*G+C;r.data[D]=
S;r.data[D+1]=T;r.data[D+2]=U;r.data[D+3]=V||255}}})});createImageBitmap(r).then(B=>{l[A]=B;a.drawImage(l[A],c-K,d)})}},m={D:"#2e2622",N:"#cccec7",B:"#77746f",A:"#a09f97"},u=Object.values(m).join("").replace(/#/g,""),aa=m.D.repeat(4).replace(/#/g,""),ba="@@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@PA@E@@@@T@@@@PA@ @@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@@E@E@@T@T@@@@PA@ @@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@@EPA@@T@E@@PA@@@ @@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@@EPA@@T@@@@PA@@@ @@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@@E@E@@T@T@@PA@@@ @@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@@E@E@@T@T@@@@PA@".split(" ");
function v(a,b,c=!1,d=!1){var f=w;let k=[];c=c?aa:u;[...a].map(g=>{g=g.charCodeAt(0);k.push(g&3);k.push(g>>2&3);k.push(g>>4&3)});a=Math.floor(Math.sqrt(k.length));f.g.save();f.g.translate(b.x+(d?a:0),b.y);f.g.save();f.g.scale(d?-1:1,1);for(b=0;b<a;b++)for(d=0;d<a;d++)if(k[b*a+d]){let g=6*(k[b*a+d]-1);f.g.fillStyle="#"+c.substring(g,g+6);f.g.fillRect(d,b,1,1)}f.g.restore();f.g.restore()}function x(a,b){n(a.g,b)}
function y(a,b,c,d,f){a.g.save();a.g.strokeStyle=d;a.g.fillStyle=f;a.g.fillRect(b.x,b.y,c.x,c.y);a.g.strokeRect(b.x+.5,b.y+.5,c.x,c.y);a.g.restore()}
function ca(){var a=w;a.g.save();a.g.translate(80,80);[{x:12,y:0},{x:0,y:12},{x:12,y:12},{x:24,y:12}].forEach(({x:b,y:c})=>{y(a,{x:b,y:c},{x:10,y:10},m.B,m.A)});x(a,{text:"move",x:18,y:30,textAlign:"center",size:2});a.g.restore();a.g.save();a.g.translate(c2d.width-80-40,80);[{text:"enter",y:0},{text:"shift",y:12}].forEach(({text:b,y:c})=>{y(a,{x:0,y:c},{x:40,y:10},m.B,m.A);x(a,{text:b,x:20,y:c+3,size:1,textAlign:"center"})});x(a,{text:"action",x:20,y:30,textAlign:"center",size:2});a.g.restore()}
class da{constructor(){this.g=c2d.getContext("2d");let a=()=>{var b=Math.min(window.innerHeight,window.innerWidth);b=Math.max(1,Math.min(b/260,b/320));c2d.style.height=`${260*b}px`;c2d.style.width=`${320*b}px`};window.addEventListener("resize",a);a();c2d.classList.remove("hidden")}}
let w=new da,ea=[{name:"Assistant Dave",F:"If you want to make it big in Hollywood kid, you better do as I say!",H:"Is that all you got?",M:"I guess you're not totally worthless!",I:"Stop wasting my time kid!",icon:"@@@@@@@UUE@@UUUA@ijjU@dfZZAPjYjE@YiVV@deZYAPjjjF@iUeZ@dZUjA@ijjA@PUUA@TjjZAdjjjZPUUUUA"},{name:"Producer Elena",F:"Just do as you're told and don't get in my way.",H:"Hurry, I don't have all day",M:"Obedient and disciplined. You'll get far, child.",I:"Is there some reason my coffee isn\t here?",
icon:"@@@@@@PUUE@PeZUAPijjU@ijjVAeUVYUTjifVQijjZEejjjUPjUjVAijjZ@PjjZ@@TiU@@@dF@@PUVUAPUUUU@"},{name:"Director Alfred",F:"Good evening. Are you ready to face your fears?",H:"Time for your final act",M:"Well done. I must admit, you handled the tension admirably.",I:"Was this worth the price of admission?",icon:"@TUU@@djjF@djjjAPUUUF@ijjV@djjjAPVjeF@ijjZ@djjjAPjUjF@djjF@@ejF@@@iF@@TeZU@TUYUEPUUUU@"},{name:"Wally",F:"I've been following you growth. Show me what you got, ha ha.",H:"The wheel must keep spinning, ha ha!",
M:"Splendid. I can definitely use you, ha ha!",I:"This just won't do ha ha",icon:"@PA@E@PU@UAPUUUU@UiVUAPijUA@djZA@PfiF@@YfZ@@djjATdjjFPejjZ@djjZ@@UUU@@@@U@@@@UE@@PUUE@"}],E=[[6,5,3,3,5,5,0,5,-2,0,-2,0,6,3,2,3],[4,3,5,4,3,5,6,4,3,5,4,3,5,6,4,3],[3,2,3,6,0,-2,0,-2,5,0,5,5,3,3,5,6]],fa=[[2,3,2.5,4],[4,3.5,3,2.5],[4,2.5,3,2]],ha=(a,b)=>c=>Math.sin(60*Math.pow(10,-(c+1)/2048%8))/8+Math.tan(Math.cbrt(Math.sin(c*a[c>>13&15]/30)))/[2,3,4,6,8,12,16,24][c/[1,1.5][c>>12&1]>>10&7]/32+Math.cbrt(Math.asin(Math.sin(c/
b[c>>16&3]/10)))/64;class ia{constructor(){this.source=null;this.h=[];this.g=new AudioContext;for(let a=0;3>a;a++){let b=E[a%E.length],c=fa[a%E.length],d=32E3*(b.length+.4)/2,f=this.g.createBuffer(1,d,32E3),k=f.getChannelData(0);for(let g=0;g<d;g++)k[g]=ha(b,c)(g);this.h.push(f)}}start(){this.g=new AudioContext;this.source=this.g.createBufferSource();this.source.buffer=this.h[0];this.source.connect(this.g.destination);this.source.loop=!0;this.source.start()}}let F;
function H(a){var b=I,c=[];b.g=a;b.g.C?.(...c)}class ja{constructor(...a){this.g=J;this.g.C?.(...a)}}let I;function L(a){return.1>a&&-.1<a?0:a}function ka(a){let b=RegExp("(.{1,40})(\\s|$)","g"),c=[],d;for(;null!==(d=b.exec(a));)c.push(d[1].trim());return c}class la{constructor(){this.i=this.g=0;this.size={x:16,y:16};this.J={x:0,y:0};this.h=!1}}let M=new la;
class ma{constructor(){this.l=this.s=this.v=this.u=this.j=this.m=!1;this.g=new Map;this.h={m:this.m,j:this.j,v:this.v,u:this.u,s:this.s,l:this.l};document.addEventListener("keydown",a=>{this.g.set(a.code,!0)});document.addEventListener("keyup",a=>{this.g.set(a.code,!1)});this.i=new DOMPoint}o(a){this.h.m=this.m;this.h.j=this.j;this.h.s=this.s;this.h.l=this.l;let b=this.g.get("KeyA")||this.g.get("KeyQ")||this.g.get("ArrowLeft")?-1:0,c=this.g.get("KeyD")||this.g.get("ArrowRight")?1:0,d=this.g.get("KeyW")||
this.g.get("KeyZ")||this.g.get("ArrowUp")?-1:0,f=this.g.get("KeyS")||this.g.get("ArrowDown")?1:0;this.i.x=b+c||0;this.i.y=d+f||0;this.m=0>this.i.y;this.j=0<this.i.y;this.u=0>this.i.x;this.v=0<this.i.x;this.s=!!this.g.get("Enter")||!!this.g.get("KeyZ");(this.l=!!this.g.get("Escape"))&&H(J);this.m&&(this.h.m||"function"==typeof a.L&&a.L());this.j&&(this.h.j||"function"==typeof a.K&&a.K());this.v&&(this.h.v||"function"==typeof a.S&&a.S());this.u&&(this.h.u||"function"==typeof a.R&&a.R());this.s&&(this.h.s||
"function"==typeof a.G&&a.G());this.l&&(this.h.l||"function"==typeof a.P&&a.P())}}let N=new ma;
class na{constructor(){this.h={x:0,y:0};this.g={x:0,y:0}}C(){}o(a){N.m?this.g.y-=.02*a:N.j?this.g.y+=.02*a:0<this.g.y?this.g.y=Math.max(0,this.g.y-.02*a):0>this.g.y&&(this.g.y=Math.min(0,this.g.y+.02*a));N.u?(this.g.x-=.02*a,M.h=!0):N.v?(this.g.x+=.02*a,M.h=!1):0<this.g.x?this.g.x=Math.max(0,this.g.x-.02*a):0>this.g.x&&(this.g.x=Math.min(0,this.g.x+.02*a));this.h={x:Math.round(this.h.x+this.g.x),y:Math.round(this.h.y+this.g.y)};this.g={x:L(Math.max(Math.min(this.g.x,3),-3)),y:L(Math.max(Math.min(this.g.y,
3),-3))};M.J=this.h;0!=this.g.x||0!=this.g.y?(M.g+=a,60<=M.g&&(M.i=(M.i+1)%6,M.g-=60),v(ba[M.i],M.J,!1,M.h)):v("@@@@@@PUUE@PjjjA@ijjF@dZjY@PjjjA@iZeF@djjZ@PUUUAPijjFPdjjZQPUUUQ@TUUA@PA@E@@E@T@@T@PA@",M.J,!1,M.h)}}
class oa extends na{o(a){super.o(a);v("p\u007f@@@@kC@@@lN@@@pz@@@@k\u007f\u007f\u007f@|njjCp~jjN@kkjz@lnjjCpzjjN@k\u007f\u007f\u007f@ljjjCpjjjN@k\u007f\u007fz@l~\u007fkCp\u007f@|O@",{x:100,y:100});v("@\u007f\u007f\u007fC@kjjz@kjjjNkjjjjojjjj~jjjjzkjjjjojjjj~kjjj~{jjjns~\u007f\u007foCljjjCp\u007f\u007f\u007fO@kCpz@lN@kCp\u007f@|O@",{x:116,y:100});v("p\u007f@@@@kC@@@lN@@@pz@@@@k\u007f\u007f\u007f@|njjCp~jjN@kkjz@lnjjCpzjjN@k\u007f\u007f\u007f@ljjjCpjjjN@k\u007f\u007fz@l~\u007fkCp\u007f@|O@",{x:132,
y:100},!1,!0);v("@@\u007fC@@pkzC@pjjz@pjnkNpjnkjCkkjnNlkjj{pzznkCkznjNpjjjN@|\u007f\u007fO@@pz@@@|\u007f\u007f@@pjjC@@ojO@@p\u007fO@@",{x:116,y:80})}}
class pa{constructor(){this.h=this.g=0}C(){}o(a){ca();this.g+=a;30<=this.g&&(this.h++,this.g-=30);y(w,{x:5,y:c2d.height-70},{x:c2d.width-10,y:50},m.A,m.N);y(w,{x:8,y:c2d.height-67},{x:c2d.width-16,y:44},m.A,m.N);let {name:b,F:c,icon:d}=ea[0];x(w,{text:b,x:12,y:c2d.height-63,size:2,color:m.B});ka(c).forEach((f,k)=>{x(w,{text:f,x:12,y:c2d.height-45+8*k,size:1,O:this.h-40*k})});w.g.save();w.g.translate(c2d.width-45,c2d.height-60);w.g.save();w.g.scale(2,2);v(d,{x:0,y:0});w.g.restore();w.g.restore()}G(){H(new oa)}}
let O=[[" Story mode",80],[" Endless mode",160]];
class qa{constructor(){this.g=0}C(){this.g=0;F&&F?.source?.stop()}o(){x(w,{text:"Levels",x:c2d.width/2,y:30,textAlign:"center",color:m.B,size:3});let a=c2d.width/2-84;[...O,["&",0===this.g?O[0][1]:O[1][1]]].forEach(([b,c])=>{x(w,{text:b,x:a-10,y:c,color:m.D,size:2})});x(w,{text:"Press ENTER to start",x:c2d.width/2,y:c2d.height-20,textAlign:"center",color:m.B,size:1});w.g.save();w.g.translate(a,100);["@@@@@@@UUE@@UUUA@ijjU@dfZZAPjYjE@YiVV@deZYAPjjjF@iUeZ@dZUjA@ijjA@PUUA@TjjZAdjjjZPUUUUA","@@@@@@PUUE@PeZUAPijjU@ijjVAeUVYUTjifVQijjZEejjjUPjUjVAijjZ@PjjZ@@TiU@@@dF@@PUVUAPUUUU@",
"@TUU@@djjF@djjjAPUUUF@ijjV@djjjAPVjeF@ijjZ@djjjAPjUjF@djjF@@ejF@@@iF@@TeZU@TUYUEPUUUU@","@PA@E@PU@UAPUUUU@UiVUAPijUA@djZA@PfiF@@YfZ@@djjATdjjFPejjZ@djjZ@@UUU@@@@U@@@@UE@@PUUE@"].forEach((b,c)=>{w.g.save();w.g.scale(2,2);c={x:21*c,y:0};y(w,c,{x:16,y:16},"transparent",m.A);v(b,c,!0);w.g.restore()});w.g.restore()}L(){console.log("up");this.g--;0>this.g&&(this.g=O.length-1)}K(){console.log("down");this.g++;this.g>O.length-1&&(this.g=0)}G(){0===this.g&&H(new pa)}}
let ra=new qa,P=["new game","continue","levels","about"];class sa{constructor(){this.g=0}C(){F&&F?.source?.stop()}o(){P.forEach((a,b)=>{x(w,{text:a,x:c2d.width/2,y:80+16*b,textAlign:"center",color:b===this.g?m.D:m.A})})}L(){console.log("up");this.g--;0>this.g&&(this.g=P.length-1)}K(){console.log("down");this.g++;this.g>P.length-1&&(this.g=0)}G(){0===this.g&&H(ra)}}let J=new sa;document.querySelector('link[type="image/x-icon"]').href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E\ud83c\udf9e%3C/text%3E%3C/svg%3E";
I=new ja(...[]);let Q=0,Y=[];F=new ia;function Z(a){let b=a-Q;Q=a;Y.push(1E3/b);15===Y.length&&(fps.innerHTML=`${Math.round(Y.reduce((c,d)=>c+d)/15)} FPS`,Y=[]);w.g.clearRect(0,0,c2d.width,c2d.height);a=I.g;N.o(a);a.o(b);requestAnimationFrame(Z)}requestAnimationFrame(Z);
